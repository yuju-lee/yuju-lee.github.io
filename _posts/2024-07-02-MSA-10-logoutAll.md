---
layout: post
title: "MSA-10. 동시 로그아웃"
tags: [JWT, JAVA-Springboot]
author: judy
published: true
categories: [logs]
date: 2024-07-02
---
발급한 모든 리퀘스트 토큰과 엑세스 토큰을 무효화하면 된다. 레디스에서 요청한 해당 이메일로 등록된 모든 토큰 데이터를 삭제하는 방식.

**as-is**
- 로그인
    1. 로그인 시 이메일 / 비번 확인
    2. 맞을 경우 리프레시 토큰 여부 확인 
        1. 리프레시 토큰 없을 경우 리프레시 / 엑세스 토큰 발급해 리프레시 토큰만 저장
        2. 리프레시 토큰 있을 경우 엑세스 토큰 발급
- 로그아웃
    1. 로그아웃 시 헤더에 엑세스 토큰을 포함해 요청
    2. 엑세스 토큰을 레디스의 블랙리스트에 등록 (1시간 뒤 사라지게 설정)

**to-be**
- 로그인
    1. 로그인 시 이메일 / 비번 확인
    2. 이메일, 비번 맞을 경우 리프레시 토큰 여부 확인
        1. 리프레시 토큰 없을 경우 리프레시 / 엑세스 토큰 발급하고 **리프레시, 엑세스 토큰 둘 다 저장**
        2. 리프레시 토큰 있을 경우 **엑세스 토큰 발급 후 저장**
- 일반 로그아웃
    1. 로그아웃 시 헤더에 엑세스 토큰을 포함해 요청
    2. 엑세스 토큰을 레디스의 블랙리스트에 등록
- 모든 기기 로그아웃
    1. 헤더에 이메일 정보를 포함해 로그아웃 요청
    2. **해당 이메일로 등록된 모든 리퀘스트, 엑세스 토큰 삭제 및 엑세스 토큰은 블랙리스트 등록**